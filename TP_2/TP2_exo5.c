#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>


void message(int sig)
{
	if(sig == SIGUSR1)
	{
		printf("ceci est un bon exercice...  (pid : %d)\n",getpid());
	}
	else if( sig == SIGUSR2)
	{
		printf("...pour comprendre les signaux   (pid : %d)\n",getpid());
	}
}

int main(int argc,char **argv)
{
		pid_t pid;

		pid = fork();

		if(pid == 0)//fils 1
		{
			signal(SIGUSR1,message);
			while(1)
			{
				printf("fils 1 attend...\n");
				sleep(1);
			}
		}
		else //pere
		{
			pid_t pido;
			pido = fork();

			if(pido == 0) //fils 2
			{
				signal(SIGUSR2,message);
				while(1)
				{
					printf("fils 2 attend...\n");
					sleep(1);
				}
			}
			else // re pere
			{
				while(1)
				{
					sleep(3);
					kill(pid,SIGUSR1);
					sleep(3);
					kill(pido,SIGUSR2);
				}
			}

		}
}
